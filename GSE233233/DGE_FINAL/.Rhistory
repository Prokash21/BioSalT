tbl <- tbl[keep, ]
ds <- DESeqDataSetFromMatrix(countData=tbl, colData=sample_info, design= ~Group)
ds <- DESeq(ds, test="LRT", reduced = ~ 1)  # Use LRT for all-around gene ranking
# extract results for top genes table
r <- results (ds, alpha=0.05, pAdjustMethod ="fdr")
tT <- r[order(r$padj)[1:250],]
tT <- merge(as.data.frame(tT), annot, by=0, sort=F)
tT <- subset(tT, select=c("GeneID","padj","pvalue","stat","baseMean","Symbol","Description"))
write.table(tT, file=stdout(), row.names=F, sep="\t")
plotDispEsts(ds, main="GSE219036 Dispersion Estimates")
# create histogram plot of p-values
hist(r$padj, breaks=seq(0, 1, length = 21), col = "grey", border = "white",
xlab = "", ylab = "", main = "GSE219036 Frequencies of padj-values")
# Wald test to obtain contrast-specific results
ds <- DESeq(ds, test="Wald", sfType="poscount")
r <- results (ds, contrast=c("Group", groups[1], groups[2]), alpha=0.05, pAdjustMethod = "fdr")
# volcano plot
old.pal <- palette(c("#00BFFF", "#FF3030")) # low-hi colors
par(mar=c(4,4,2,1), cex.main=1.5)
plot(r$log2FoldChange, -log10(r$padj), main=paste(groups[1], "vs", groups[2]),
xlab="log2FC", ylab="-log10(Padj)", pch=20, cex=0.5)
with(subset(r, padj<0.05 & abs(log2FoldChange) >= 0),
points(log2FoldChange, -log10(padj), pch=20, col=(sign(log2FoldChange) + 3)/2, cex=1))
legend("bottomleft", title=paste("Padj<", 0.05, sep=""), legend=c("down", "up"), pch=20,col=1:2)
# MD plot
par(mar=c(4,4,2,1), cex.main=1.5)
plot(log10(r$baseMean), r$log2FoldChange, main=paste(groups[1], "vs", groups[2]),
xlab="log10(mean of normalized counts)", ylab="log2FoldChange", pch=20, cex=0.5)
with(subset(r, padj<0.05 & abs(log2FoldChange) >= 0),
points(log10(baseMean), log2FoldChange, pch=20, col=(sign(log2FoldChange) + 3)/2, cex=1))
legend("bottomleft", title=paste("Padj<", 0.05, sep=""), legend=c("down", "up"), pch=20,col=1:2)
abline(h=0)
palette(old.pal) # restore palette
# Venn diagram
library(gplots)
all_res <- list()
ct.names <- resultsNames(ds)[-1] # contrasts names without Intercept
for (ct in ct.names) {
r <- results(ds, name=ct, alpha=0.05, pAdjustMethod = "fdr")
all_res[[length(all_res) + 1]] <- rownames(r)[!is.na(r$padj) & r$padj < 0.05 & abs(r$log2FoldChange) >= 0]
}
names(all_res) <- ct.names
venn(all_res)
################################################################
#   General expression data visualization
dat <- log10(counts(ds, normalized = T) + 1) # extract normalized counts
# box-and-whisker plot
lbl <- "log10(raw counts + 1)"
ord <- order(gs)  # order samples by group
palette(c("#1B9E77", "#7570B3", "#E7298A", "#E6AB02", "#D95F02",
"#66A61E", "#A6761D", "#B32424", "#B324B3", "#666666"))
par(mar=c(7,4,2,1))
boxplot(dat[,ord], boxwex=0.6, notch=T, main="GSE219036", ylab="lg(norm.counts)", outline=F, las=2, col=gs[ord])
legend("topleft", groups, fill=palette(), bty="n")
# UMAP plot (multi-dimensional scaling)
library(umap)
dat <- dat[!duplicated(dat), ] # first remove duplicates
par(mar=c(3,3,2,6), xpd=TRUE, cex.main=1.5)
ump <- umap(t(dat), n_neighbors = 5, random_state = 123)
plot(ump$layout, main="UMAP plot, nbrs=5", xlab="", ylab="", col=gs, pch=20, cex=1.5)
legend("topright", inset=c(-0.15,0), legend=groups, pch=20,
col=1:length(groups), title="Group", pt.cex=1.5)
library(DESeq2)
library(DESeq2)
library(pheatmap)
# Specify the file path to your TSV file
file_path <- "D:/JP_MHB/AlphaMissense_aa_substitutions.tsv"
# Using read.table()
data <- read.table(file_path, header = TRUE, sep = "\t")
View(data)
write.csv(data,file="AlphaMissense_aa_substitutions")
write.csv(data,"AlphaMissense_aa_substitutions.csv", row.names = FALSE)
# Specify the file path to your TSV file
file_path <- "D:/JP_MHB/AlphaMissense_aa_substitutions.tsv"
getwd()
# Install and load the clusterProfiler package
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("clusterProfiler")
library(clusterProfiler)
# Load your gene list
my_gene_list <- c("WDR37", "NFAT5", "ICAM5", "ICAM5",
"ICAM5", "ELL", "PLAGL1", "DHX38", "GATA6", "ZNF212", "CBX6")  # Replace with your gene symbols
# Load the gene-to-GO mapping data (use the appropriate organism database)
if (!requireNamespace("org.Hs.eg.db", quietly = TRUE))
BiocManager::install("org.Hs.eg.db")
library(org.Hs.eg.db)
# Perform GO enrichment analysis (Biological Process)
go_enrichment <- enrichGO(
gene          = my_gene_list,
OrgDb         = org.Hs.eg.db,  # Replace with the appropriate organism database
keyType       = "SYMBOL",
ont           = "BP",  # BP for Biological Process, MF for Molecular Function, CC for Cellular Component
pAdjustMethod = "fdr",  # Adjust p-values for multiple testing
pvalueCutoff  = 0.05
)
# View the results
summary(go_enrichment)
# View the results using as.data.frame
result_df <- as.data.frame(go_enrichment)
# View the results
print(result_df)
View(go_enrichment)
go_enrichment@result
# View the results
summary(go_enrichment)
# View the results using as.data.frame
result_df <- as.data.frame(go_enrichment)
# View the results
print(result_df)
# Perform GO enrichment analysis (Biological Process)
go_enrichment <- enrichGO(
gene          = my_gene_list,
OrgDb         = org.Hs.eg.db,  # Replace with the appropriate organism database
keyType       = "SYMBOL",
ont           = "MF",  # BP for Biological Process, MF for Molecular Function, CC for Cellular Component
pAdjustMethod = "fdr",  # Adjust p-values for multiple testing
pvalueCutoff  = 0.05
)
# View the results
summary(go_enrichment)
# Perform GO enrichment analysis (Biological Process)
go_enrichment <- enrichGO(
gene          = my_gene_list,
OrgDb         = org.Hs.eg.db,  # Replace with the appropriate organism database
keyType       = "SYMBOL",
ont           = "CC",  # BP for Biological Process, MF for Molecular Function, CC for Cellular Component
pAdjustMethod = "fdr",  # Adjust p-values for multiple testing
pvalueCutoff  = 0.05
)
# View the results
summary(go_enrichment)
View(go_enrichment)
go_enrichment@result[["Description"]]
x<-go_enrichment@result
View(x)
clear
#set the working directory
setwd("D:/DWCT/M_Analysis_Ajit_Sir/GSE148353")
#
#
#
library(DESeq2)
library(pheatmap)
library(dplyr)
library(RColorBrewer)
library(ggplot2)
library(ggrepel)
count_data <- read.csv("Count_Data_Run.csv", header=TRUE,row.names = 1)
colnames(count_data)
head(count_data)
sample_info <- read.csv("Meta_Data_Run.csv", header = TRUE,row.names = 1)
#colData1 <- read.csv("meta_keratinocyte.csv", header = T, sep = '\t',
#                     stringsAsFactors = TRUE)
#colData <- read.csv("meta_keratinocyte.csv", header = TRUE,row.names = 1)
colnames(sample_info)
head(sample_info)
sample_info$Time_point <- factor(sample_info$Time)
# Convert non-integer values to integers in count data
count_data <- round(count_data)
head(count_data)
# Create a new count data object
new_count_data <- as.matrix(count_data)
head(new_count_data)
unique(sample_info$Time)
dim(count_data)
dim(new_count_data)
dim(sample_info)
# Generate the DESeqDataSet object
dds <- DESeqDataSetFromMatrix(countData = new_count_data, colData = sample_info, design = ~ Time)
# Generate the DESeqDataSet object
dds <- DESeqDataSetFromMatrix(countData = new_count_data, colData = sample_info, design = ~ Time)
View(count_data)
#set factor levels
#sample_info$agent <- factor(sample_info$agent)
sample_info$Time <- factor(sample_info$Time)
# Convert non-integer values to integers in count data
count_data <- round(count_data)
head(count_data)
# Create a new count data object
new_count_data <- as.matrix(count_data)
head(new_count_data)
unique(sample_info$Time)
dim(count_data)
dim(new_count_data)
dim(sample_info)
# Generate the DESeqDataSet object
dds <- DESeqDataSetFromMatrix(countData = new_count_data, colData = sample_info, design = ~ Time)
# Perform DESeq2 analysis
dds <- DESeq(dds)
head(dds)
sample_info1 <- read.csv("meta_keratinocyte.csv")
sample_info <- read.csv("Meta_Data_Run.csv", header = TRUE,row.names = 1)
#colData1 <- read.csv("meta_keratinocyte.csv", header = T, sep = '\t',
#                     stringsAsFactors = TRUE)
#colData <- read.csv("meta_keratinocyte.csv", header = TRUE,row.names = 1)
colnames(sample_info)
head(sample_info)
#set factor levels
#sample_info$agent <- factor(sample_info$agent)
sample_info$Time <- factor(sample_info$Time)
#sample_info$tissue <- factor(sample_info$tissue)
# Convert non-integer values to integers in count data
count_data <- round(count_data)
head(count_data)
# Create a new count data object
new_count_data <- as.matrix(count_data)
head(new_count_data)
unique(sample_info$Time)
dim(count_data)
dim(new_count_data)
dim(sample_info)
# Generate the DESeqDataSet object
dds <- DESeqDataSetFromMatrix(countData = new_count_data, colData = sample_info, design = ~ Time)
# Perform DESeq2 analysis
dds <- DESeq(dds)
head(dds)
#set the factor level
dds$Treatment <- factor(dds$agent, levels = c ("control","Salt stress"))
# Perform DESeq2 analysis
dds <- DESeq(dds)
View(sample_info)
head(dds)
#set the factor level
dds$Treatment <- factor(dds$agent, levels = c ("control","Salt stress"))
View(dds)
#set the factor level
dds$Time <- factor(dds$Time, levels = c ("control","Salt stress"))
#filter the genes
keep <- rowSums(counts(dds)) >= 5
dds <- dds[keep,]
dds
#set the referene for the treatment factor
dds$agent <- relevel(dds$agent , ref = "control")
#set the referene for the treatment factor
dds$Time <- relevel(dds$Time , ref = "control")
dds$Time
#perform the statistical tests to identify differentialy expressed genes
dds <- DESeq(dds)
head(dds)
#save the normalized counts
normalize_counts <- counts(dds,normalized=TRUE)
head(normalize_counts)
dim(normalize_counts)
write.csv(normalize_counts,"Salt stress_vs_control.csv")
#Identify available coefficient names
coeff_names <- resultsNames(dds)
#Print the coefficient names
print(coeff_names)
resLFC <- lfcShrink(dds, coef ="Time_Salt.stress_vs_control"  , type = "apeglm")
#change resLFC to a dataframe
resLFC <- as.data.frame(resLFC)
resLFC_p_cut <- as.data.frame(resLFC[ resLFC$padj<0.05,])
write.csv(resLFC_p_cut, file = "resLFC_p_cut.csv")
#################
# Create a Volcano Plot
ggplot(resLFC,aes(x = log2FoldChange, y = -log10(padj))) +
# Scatter plot points with color-coded regulation
geom_point(aes(color = ifelse(log2FoldChange > 1.0 & -log10(padj) > 1.3, "Upregulated",
ifelse(log2FoldChange < -1.0 & -log10(padj) > 1.3, "Downregulated", "Not Significant"))),
size = 2.5, alpha = 0.5) +
# Add horizontal dashed line
geom_hline(yintercept = 1.3, linetype = "dashed", color = "black") +
# Add vertical dashed lines
geom_vline(xintercept = c(-1, 1), linetype = "dashed", color = "black") +
# Customize plot labels and add the header
labs(
title = "HeatMap of agent_Salt.stress_vs_control", # Add the header here
x = "Log2 Fold Change",
y = "-log10(padj)",
color = "Regulation"
) +
# Customize color palette for regulation categories
scale_color_manual(values = c("Upregulated" = "red", "Downregulated" = "blue", "Not Significant" = "gray")) +
# Use a minimal theme for the plot
theme_minimal()
Upregulated <- resLFC[resLFC$log2FoldChange > 1 & resLFC$padj < 0.05, ]
top_UP_hits1 <- Upregulated[order(Upregulated$padj ),]
top_UP_hits <- Upregulated[order(Upregulated$padj),][1:20,]
top_UP_hits1 <-row.names(top_UP_hits1)
top_UP_hits <-row.names(top_UP_hits)
top_UP_hits
write.csv(top_UP_hits, file = "UP_top_20_agent_Salt.stress_vs_control.csv", row.names = FALSE)
Downregulated <- resLFC[resLFC$log2FoldChange < -1 & resLFC$padj < 0.05, ]
top_hits1 <- Downregulated[order(Downregulated$padj),]
top_hits <- Downregulated[order(Downregulated$padj),][1:20,]
top_hits1 <-row.names(top_hits1)
top_hits <-row.names(top_hits)
top_hits
write.csv(top_hits, file = "DOWN_top_20_agent_Salt.stress_vs_control.csv", row.names = FALSE)
write.csv(top_UP_hits1, file = "UP_Salt.stress_vs_control.csv", row.names = FALSE)
write.csv(top_hits1, file = "DOWN_agent_Salt.stress_vs_control.csv", row.names = FALSE)
#
#
#
library(DESeq2)
library(pheatmap)
library(dplyr)
library(RColorBrewer)
library(ggplot2)
library(ggrepel)
getwd()
#set the working directory
setwd("D:/DWCT/M_Analysis_Ajit_Sir/GSE152620")
#D:\DWCT\M_Analysis_Ajit_Sir\GSE152620
#load the count data
count_data <- read.csv("Count_Data_final.csv", header=TRUE,row.names = 1)
colnames(count_data)
head(count_data)
#load the sample info
#sample_info1 <- read.csv("meta_keratinocyte.csv")
sample_info <- read.csv("Meta_Data_final.csv", header = TRUE,row.names = 1)
#colData1 <- read.csv("meta_keratinocyte.csv", header = T, sep = '\t',
#                     stringsAsFactors = TRUE)
#colData <- read.csv("meta_keratinocyte.csv", header = TRUE,row.names = 1)
colnames(sample_info)
head(sample_info)
#set factor levels
sample_info$treatment <- factor(sample_info$treatment)
#sample_info$Time_point <- factor(sample_info$Time_point)
#sample_info$tissue <- factor(sample_info$tissue)
# Convert non-integer values to integers in count data
count_data <- round(count_data)
head(count_data)
# Create a new count data object
new_count_data <- as.matrix(count_data)
head(new_count_data)
unique(sample_info$treatment)
#unique(sample_info$Time_point)
#unique(sample_info$tissue)
dim(count_data)
dim(new_count_data)
dim(sample_info)
# Generate the DESeqDataSet object
dds <- DESeqDataSetFromMatrix(countData = new_count_data, colData = sample_info, design = ~ treatment)
# Perform DESeq2 analysis
dds <- DESeq(dds)
head(dds)
#set the factor level
dds$treatment <- factor(dds$treatment, levels = c ("Control","Salinity","Heat","Salinity + heat"))
#filter the genes
keep <- rowSums(counts(dds)) >= 5
dds <- dds[keep,]
dds
#set the referene for the treatment factor
dds$treatment <- relevel(dds$treatment , ref = "Control")
dds$treatment
#perform the statistical tests to identify differentialy expressed genes
dds <- DESeq(dds)
head(dds)
#save the normalized counts
normalize_counts <- counts(dds,normalized=TRUE)
head(normalize_counts)
dim(normalize_counts)
write.csv(normalize_counts,"Salt stress_vs_control.csv")
#Identify available coefficient names
coeff_names <- resultsNames(dds)
#Print the coefficient names
print(coeff_names)
#[1] "Intercept"                    "agent_Salt.stress_vs_control"
resLFC <- lfcShrink(dds, coef ="treatment_Salinity_vs_Control"  , type = "apeglm")
#change resLFC to a dataframe
resLFC <- as.data.frame(resLFC)
write.csv(resLFC,"res_lfc_stress_vs_control.csv")
##################18th oct
resLFC_p_cut <- as.data.frame(resLFC[ resLFC$padj<0.05,])
write.csv(resLFC_p_cut, file = "resLFC_p_cut.csv")
#################
# Create a Volcano Plot
ggplot(resLFC,aes(x = log2FoldChange, y = -log10(padj))) +
# Scatter plot points with color-coded regulation
geom_point(aes(color = ifelse(log2FoldChange > 1.0 & -log10(padj) > 1.3, "Upregulated",
ifelse(log2FoldChange < -1.0 & -log10(padj) > 1.3, "Downregulated", "Not Significant"))),
size = 2.5, alpha = 0.5) +
# Add horizontal dashed line
geom_hline(yintercept = 1.3, linetype = "dashed", color = "black") +
# Add vertical dashed lines
geom_vline(xintercept = c(-1, 1), linetype = "dashed", color = "black") +
# Customize plot labels and add the header
labs(
title = "HeatMap of agent_Salt.stress_vs_control", # Add the header here
x = "Log2 Fold Change",
y = "-log10(padj)",
color = "Regulation"
) +
# Customize color palette for regulation categories
scale_color_manual(values = c("Upregulated" = "red", "Downregulated" = "blue", "Not Significant" = "gray")) +
# Use a minimal theme for the plot
theme_minimal()
########################################## padj #############################################
Upregulated <- resLFC[resLFC$log2FoldChange > 1 & resLFC$padj < 0.05, ]
top_UP_hits1 <- Upregulated[order(Upregulated$padj ),]
top_UP_hits <- Upregulated[order(Upregulated$padj),][1:20,]
top_UP_hits1 <-row.names(top_UP_hits1)
top_UP_hits <-row.names(top_UP_hits)
top_UP_hits
write.csv(top_UP_hits1, file = "UP_Salt.stress_vs_control.csv", row.names = FALSE)
write.csv(top_UP_hits, file = "UP_top_20_agent_Salt.stress_vs_control.csv", row.names = FALSE)
Downregulated <- resLFC[resLFC$log2FoldChange < -1 & resLFC$padj < 0.05, ]
top_hits1 <- Downregulated[order(Downregulated$padj),]
top_hits <- Downregulated[order(Downregulated$padj),][1:20,]
top_hits1 <-row.names(top_hits1)
top_hits <-row.names(top_hits)
top_hits
write.csv(top_hits1, file = "DOWN_agent_Salt.stress_vs_control.csv", row.names = FALSE)
write.csv(top_hits, file = "DOWN_top_20_agent_Salt.stress_vs_control.csv", row.names = FALSE)
#Heatmap
top_hits <-read.csv("Afser_Vai_Copy of ID.csv")
top_hits <- top_hits$Transcript.ID#[1:20,]
# Calculate Z-scores for the top 20 gene
cal_z_score <- function(x) {
(x - mean(x)) / sd(x)
}
zscore_all <- t(apply(normalize_counts, 1, cal_z_score))
zscore_subset <- zscore_all[top_hits, ]
write.csv(zscore_subset, file = "Heatmap_Salt.stress_vs_control.csv")
pheatmap(zscore_subset,
main = "Heatmap of Z scores" )
#set the working directory
setwd("D:/DWCT/M_Analysis_Ajit_Sir/GSE233233/DGE_FINAL")
count_data <- read.csv("Count_Data_final.csv", header=TRUE,row.names = 1)
colnames(count_data)
head(count_data)
sample_info <- read.csv("Meta_Data_final.csv", header = TRUE,row.names = 1)
#colData1 <- read.csv("meta_keratinocyte.csv", header = T, sep = '\t',
#                     stringsAsFactors = TRUE)
#colData <- read.csv("meta_keratinocyte.csv", header = TRUE,row.names = 1)
colnames(sample_info)
head(sample_info)
#set factor levels
sample_info$agent <- factor(sample_info$agent)
sample_info$Time_point <- factor(sample_info$Time_point)
sample_info$tissue <- factor(sample_info$tissue)
# Convert non-integer values to integers in count data
count_data <- round(count_data)
head(count_data)
# Create a new count data object
new_count_data <- as.matrix(count_data)
head(new_count_data)
unique(sample_info$agent)
unique(sample_info$Time_point)
unique(sample_info$tissue)
dim(count_data)
dim(new_count_data)
dim(sample_info)
# Generate the DESeqDataSet object
dds <- DESeqDataSetFromMatrix(countData = new_count_data, colData = sample_info, design = ~ agent)
# Perform DESeq2 analysis
dds <- DESeq(dds)
dds$agent <- factor(dds$agent, levels = c ("control","Salt stress"))
#filter the genes
keep <- rowSums(counts(dds)) >= 5
dds <- dds[keep,]
dds
#set the referene for the treatment factor
dds$agent <- relevel(dds$agent , ref = "control")
dds$agent
#perform the statistical tests to identify differentialy expressed genes
dds <- DESeq(dds)
head(dds)
#save the normalized counts
normalize_counts <- counts(dds,normalized=TRUE)
head(normalize_counts)
dim(normalize_counts)
write.csv(normalize_counts,"Salt stress_vs_control.csv")
#Identify available coefficient names
coeff_names <- resultsNames(dds)
#Print the coefficient names
print(coeff_names)
resLFC <- lfcShrink(dds, coef ="agent_Salt.stress_vs_control"  , type = "apeglm")
#change resLFC to a dataframe
resLFC <- as.data.frame(resLFC)
resLFC_p_cut <- as.data.frame(resLFC[ resLFC$padj<0.05,])
write.csv(resLFC_p_cut, file = "resLFC_p_cut.csv")
#################
# Create a Volcano Plot
ggplot(resLFC,aes(x = log2FoldChange, y = -log10(padj))) +
# Scatter plot points with color-coded regulation
geom_point(aes(color = ifelse(log2FoldChange > 1.0 & -log10(padj) > 1.3, "Upregulated",
ifelse(log2FoldChange < -1.0 & -log10(padj) > 1.3, "Downregulated", "Not Significant"))),
size = 2.5, alpha = 0.5) +
# Add horizontal dashed line
geom_hline(yintercept = 1.3, linetype = "dashed", color = "black") +
# Add vertical dashed lines
geom_vline(xintercept = c(-1, 1), linetype = "dashed", color = "black") +
# Customize plot labels and add the header
labs(
title = "HeatMap of agent_Salt.stress_vs_control", # Add the header here
x = "Log2 Fold Change",
y = "-log10(padj)",
color = "Regulation"
) +
# Customize color palette for regulation categories
scale_color_manual(values = c("Upregulated" = "red", "Downregulated" = "blue", "Not Significant" = "gray")) +
# Use a minimal theme for the plot
theme_minimal()
Upregulated <- resLFC[resLFC$log2FoldChange > 1 & resLFC$padj < 0.05, ]
top_UP_hits1 <- Upregulated[order(Upregulated$padj ),]
top_UP_hits <- Upregulated[order(Upregulated$padj),][1:20,]
top_UP_hits1 <-row.names(top_UP_hits1)
top_UP_hits <-row.names(top_UP_hits)
top_UP_hits
write.csv(top_UP_hits, file = "UP_top_20_agent_Salt.stress_vs_control.csv", row.names = FALSE)
Downregulated <- resLFC[resLFC$log2FoldChange < -1 & resLFC$padj < 0.05, ]
top_hits1 <- Downregulated[order(Downregulated$padj),]
top_hits <- Downregulated[order(Downregulated$padj),][1:20,]
top_hits1 <-row.names(top_hits1)
top_hits <-row.names(top_hits)
top_hits
write.csv(top_hits, file = "DOWN_top_20_agent_Salt.stress_vs_control.csv", row.names = FALSE)
write.csv(top_UP_hits1, file = "UP_Salt.stress_vs_control.csv", row.names = FALSE)
write.csv(top_hits1, file = "DOWN_agent_Salt.stress_vs_control.csv", row.names = FALSE)
