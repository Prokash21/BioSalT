# Check the version of pROC package
packageVersion("pROC")
# Check the version of randomForest package
packageVersion("randomForest")
# Load libraries
library(umap)
library(ggplot2)
# Example gene expression data
gene_expression_data <- data.frame(
Gene1 = c(2.1, 1.8, 2.5, 2.3, 1.9, 2.0, 2.2, 2.4, 2.7, 2.6),
Gene2 = c(1.5, 2.0, 1.2, 1.7, 1.9, 1.8, 1.6, 1.3, 1.1, 1.4),
Gene3 = c(3.2, 3.5, 3.0, 3.3, 3.1, 3.4, 2.8, 3.6, 2.9, 3.1),
Gene4 = c(0.8, 1.2, 1.0, 0.9, 1.1, 1.3, 0.7, 1.4, 0.8, 1.5),
Gene5 = c(2.9, 3.1, 2.7, 3.0, 2.8, 3.2, 2.5, 3.3, 2.6, 3.4)
)
# Example metadata
metadata <- data.frame(
SampleID = paste0("Sample", 1:10),
Condition = c("Control", "Treatment", "Control", "Treatment", "Treatment",
"Control", "Treatment", "Control", "Control", "Treatment")
)
# Perform UMAP dimensionality reduction
umap_result <- umap(gene_expression_data, n_neighbors = 5, min_dist = 0.5)
# Combine UMAP results with metadata
umap_df <- cbind(umap_result$layout, metadata)
# Plot using ggplot2
ggplot(umap_df, aes(x = X1, y = X2, color = Condition)) +
geom_point(size = 3) +
scale_color_manual(values = c("blue", "red")) +  # Define colors for conditions
labs(title = "UMAP Visualization of Gene Expression Data",
x = "UMAP Component 1", y = "UMAP Component 2") +
theme_minimal()
# Load libraries
library(umap)
library(ggplot2)
# Example gene expression data
gene_expression_data <- data.frame(
Gene1 = c(2.1, 1.8, 2.5, 2.3, 1.9, 2.0, 2.2, 2.4, 2.7, 2.6),
Gene2 = c(1.5, 2.0, 1.2, 1.7, 1.9, 1.8, 1.6, 1.3, 1.1, 1.4),
Gene3 = c(3.2, 3.5, 3.0, 3.3, 3.1, 3.4, 2.8, 3.6, 2.9, 3.1),
Gene4 = c(0.8, 1.2, 1.0, 0.9, 1.1, 1.3, 0.7, 1.4, 0.8, 1.5),
Gene5 = c(2.9, 3.1, 2.7, 3.0, 2.8, 3.2, 2.5, 3.3, 2.6, 3.4)
)
# Example metadata
metadata <- data.frame(
SampleID = paste0("Sample", 1:10),
Condition = c("Control", "Treatment", "Control", "Treatment", "Treatment",
"Control", "Treatment", "Control", "Control", "Treatment")
)
# Perform UMAP dimensionality reduction
umap_result <- umap(gene_expression_data, n_neighbors = 5, min_dist = 0.5)
# Combine UMAP results with metadata
umap_df <- cbind(umap_result$layout, metadata)
# Plot using ggplot2
ggplot(umap_df, aes(x = X1, y = X2, color = Condition)) +
geom_point(size = 3) +
scale_color_manual(values = c("blue", "red")) +  # Define colors for conditions
labs(title = "UMAP Visualization of Gene Expression Data",
x = "UMAP Component 1", y = "UMAP Component 2") +
theme_minimal()
############################################
# Load libraries
library(umap)
library(ggplot2)
# Example gene expression data
gene_expression_data <- data.frame(
Gene1 = c(2.1, 1.8, 2.5, 2.3, 1.9, 2.0, 2.2, 2.4, 2.7, 2.6),
Gene2 = c(1.5, 2.0, 1.2, 1.7, 1.9, 1.8, 1.6, 1.3, 1.1, 1.4),
Gene3 = c(3.2, 3.5, 3.0, 3.3, 3.1, 3.4, 2.8, 3.6, 2.9, 3.1),
Gene4 = c(0.8, 1.2, 1.0, 0.9, 1.1, 1.3, 0.7, 1.4, 0.8, 1.5),
Gene5 = c(2.9, 3.1, 2.7, 3.0, 2.8, 3.2, 2.5, 3.3, 2.6, 3.4)
)
# Example metadata
metadata <- data.frame(
SampleID = paste0("Sample", 1:10),
Condition = c("Control", "Treatment", "Control", "Treatment", "Treatment",
"Control", "Treatment", "Control", "Control", "Treatment")
)
# Perform UMAP dimensionality reduction
umap_result <- umap(gene_expression_data, n_neighbors = 5, min_dist = 0.5)
# Extract UMAP coordinates and combine with metadata
umap_df <- data.frame(
X1 = umap_result$layout[, 1],  # UMAP component 1
X2 = umap_result$layout[, 2],  # UMAP component 2
metadata
)
# Plot using ggplot2
ggplot(umap_df, aes(x = X1, y = X2, color = Condition)) +
geom_point(size = 3) +
scale_color_manual(values = c("blue", "red")) +  # Define colors for conditions
labs(title = "UMAP Visualization of Gene Expression Data",
x = "UMAP Component 1", y = "UMAP Component 2") +
theme_minimal()
############################################
# Load libraries
library(umap)
library(ggplot2)
# Example gene expression data
gene_expression_data <- data.frame(
Gene1 = c(2.1, 1.8, 2.5, 2.3, 1.9, 2.0, 2.2, 2.4, 2.7, 2.6),
Gene2 = c(1.5, 2.0, 1.2, 1.7, 1.9, 1.8, 1.6, 1.3, 1.1, 1.4),
Gene3 = c(3.2, 3.5, 3.0, 3.3, 3.1, 3.4, 2.8, 3.6, 2.9, 3.1),
Gene4 = c(0.8, 1.2, 1.0, 0.9, 1.1, 1.3, 0.7, 1.4, 0.8, 1.5),
Gene5 = c(2.9, 3.1, 2.7, 3.0, 2.8, 3.2, 2.5, 3.3, 2.6, 3.4)
)
# Example metadata
metadata <- data.frame(
SampleID = paste0("Sample", 1:10),
Condition = c("Control", "Treatment", "Control", "Treatment", "Treatment",
"Control", "Treatment", "Control", "Control", "Treatment")
)
# Perform UMAP dimensionality reduction
umap_result <- umap(gene_expression_data, n_neighbors = 5, min_dist = 0.5)
# Extract UMAP coordinates and combine with metadata
umap_df <- data.frame(
X1 = umap_result$layout[, 1],  # UMAP component 1
X2 = umap_result$layout[, 2],  # UMAP component 2
metadata
)
# Plot using ggplot2
ggplot(umap_df, aes(x = X1, y = X2, color = Condition)) +
geom_point(size = 3) +
scale_color_manual(values = c("blue", "red")) +  # Define colors for conditions
labs(title = "UMAP Visualization of Gene Expression Data",
x = "UMAP Component 1", y = "UMAP Component 2") +
theme_minimal()
View(gene_expression_data)
View(metadata)
############################################
# Load libraries
library(umap)
library(ggplot2)
# Example gene expression data
gene_expression_data <- data.frame(
Gene1 = c(2.1, 1.8, 2.5, 2.3, 1.9, 2.0, 2.2, 2.4, 2.7, 2.6),
Gene2 = c(1.5, 2.0, 1.2, 1.7, 1.9, 1.8, 1.6, 1.3, 1.1, 1.4),
Gene3 = c(3.2, 3.5, 3.0, 3.3, 3.1, 3.4, 2.8, 3.6, 2.9, 3.1),
Gene4 = c(0.8, 1.2, 1.0, 0.9, 1.1, 1.3, 0.7, 1.4, 0.8, 1.5),
Gene5 = c(2.9, 3.1, 2.7, 3.0, 2.8, 3.2, 2.5, 3.3, 2.6, 3.4)
)
# Example metadata
metadata <- data.frame(
SampleID = paste0("Sample", 1:10),
Condition = c("Control", "Treatment", "Control", "Treatment", "Treatment",
"Control", "Treatment", "Control", "Control", "Treatment")
)
# Perform UMAP dimensionality reduction
umap_result <- umap(gene_expression_data, n_neighbors = 5, min_dist = 0.5)
# Extract UMAP coordinates and combine with metadata
umap_df <- data.frame(
X1 = umap_result$layout[, 1],  # UMAP component 1
X2 = umap_result$layout[, 2],  # UMAP component 2
metadata
)
# Plot using ggplot2
ggplot(umap_df, aes(x = X1, y = X2, color = Condition)) +
geom_point(size = 3) +
scale_color_manual(values = c("blue", "red")) +  # Define colors for conditions
labs(title = "UMAP Visualization of Gene Expression Data",
x = "UMAP Component 1", y = "UMAP Component 2") +
theme_minimal()
############################################
# Load libraries
library(umap)
library(ggplot2)
# Example gene expression data
gene_expression_data <- data.frame(
Gene1 = c(2.1, 1.8, 2.5, 2.3, 1.9, 2.0, 2.2, 2.4, 2.7, 2.6),
Gene2 = c(1.5, 2.0, 1.2, 1.7, 1.9, 1.8, 1.6, 1.3, 1.1, 1.4),
Gene3 = c(3.2, 3.5, 3.0, 3.3, 3.1, 3.4, 2.8, 3.6, 2.9, 3.1),
Gene4 = c(0.8, 1.2, 1.0, 0.9, 1.1, 1.3, 0.7, 1.4, 0.8, 1.5),
Gene5 = c(2.9, 3.1, 2.7, 3.0, 2.8, 3.2, 2.5, 3.3, 2.6, 3.4)
)
# Example metadata
metadata <- data.frame(
SampleID = paste0("Sample", 1:10),
Condition = c("Control", "Treatment", "Control", "Treatment", "Treatment",
"Control", "Treatment", "Control", "Control", "Treatment")
)
# Perform UMAP dimensionality reduction
umap_result <- umap(gene_expression_data, n_neighbors = 5, min_dist = 0.5)
# Extract UMAP coordinates and combine with metadata
umap_df <- data.frame(
X1 = umap_result$layout[, 1],  # UMAP component 1
X2 = umap_result$layout[, 2],  # UMAP component 2
metadata
)
# Plot using ggplot2
ggplot(umap_df, aes(x = X1, y = X2, color = Condition)) +
geom_point(size = 3) +
scale_color_manual(values = c("blue", "red")) +  # Define colors for conditions
labs(title = "UMAP Visualization of Gene Expression Data",
x = "UMAP Component 1", y = "UMAP Component 2") +
theme_minimal()
############################################
# Load libraries
library(umap)
library(ggplot2)
# Example gene expression data
gene_expression_data <- data.frame(
Gene1 = c(2.1, 1.8, 2.5, 2.3, 1.9, 2.0, 2.2, 2.4, 2.7, 2.6),
Gene2 = c(1.5, 2.0, 1.2, 1.7, 1.9, 1.8, 1.6, 1.3, 1.1, 1.4),
Gene3 = c(3.2, 3.5, 3.0, 3.3, 3.1, 3.4, 2.8, 3.6, 2.9, 3.1),
Gene4 = c(0.8, 1.2, 1.0, 0.9, 1.1, 1.3, 0.7, 1.4, 0.8, 1.5),
Gene5 = c(2.9, 3.1, 2.7, 3.0, 2.8, 3.2, 2.5, 3.3, 2.6, 3.4)
)
# Example metadata
metadata <- data.frame(
SampleID = paste0("Sample", 1:10),
Condition = c("Control", "Treatment", "Control", "Treatment", "Treatment",
"Control", "Treatment", "Control", "Control", "Treatment")
)
# Perform UMAP dimensionality reduction
umap_result <- umap(gene_expression_data, n_neighbors = 5, min_dist = 0.5)
# Extract UMAP coordinates and combine with metadata
umap_df <- data.frame(
X1 = umap_result$layout[, 1],  # UMAP component 1
X2 = umap_result$layout[, 2],  # UMAP component 2
metadata
)
# Plot using ggplot2
ggplot(umap_df, aes(x = X1, y = X2, color = Condition)) +
geom_point(size = 3) +
scale_color_manual(values = c("blue", "red")) +  # Define colors for conditions
labs(title = "UMAP Visualization of Gene Expression Data",
x = "UMAP Component 1", y = "UMAP Component 2") +
theme_minimal()
install.packages("ape")
BiocManager::install("ape")
#PS
#set the working directory
setwd("E:/DWCT/M_Analysis_Ajit_Sir/GSE233233/DGE_FINAL/June_Run/GSE233233_QZ_006")
# Load libraries
library(umap)
library(ggplot2)
# Example gene expression data (assuming you are reading from CSV files)
gene_expression_data1 <- read.csv("Count_Data_final.csv", row.names = 1)
gene_expression_data2 <- gene_expression_data1 [1:18]
# Example metadata (assuming you are reading from CSV files)
metadata1 <- read.csv("Meta_Data_final.csv")
metadata <- metadata1[1:18,]
library(ape)
library(ggplot2)
library(ggtree)
gene_expression_data <- gene_expression_data2
# Compute distance matrix
dist_matrix <- dist(t(gene_expression_data))
# Perform hierarchical clustering
hc <- hclust(dist_matrix)
# Convert to a phylogenetic tree
phylo_tree <- as.phylo(hc)
# Define groups for coloring (example)
groups <- rep(1:2, each = 5)
groups <- rep(metadata$agent)
# Create a data frame for group information
group_df <- data.frame(label = phylo_tree$tip.label, group = factor(groups))
# Visualize the phylogenetic tree with colors
ggtree(phylo_tree) %<+% group_df +
geom_tiplab(aes(color = group), size = 3) +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "right")
