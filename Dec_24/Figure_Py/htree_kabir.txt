def plot_hierarchical_tree(df):
    # Drop metadata columns to retain only expression data
    X = df.drop(columns=['SampleID', 'condition'])
    
    # Calculate pairwise distances
    distance_matrix = pdist(X, metric='euclidean')
    
    # Perform hierarchical clustering
    linkage_matrix = linkage(distance_matrix, method='ward')
    
    # Plot the dendrogram
    plt.figure(figsize=(12, 8))
    dendrogram(
        linkage_matrix,
        labels=df['SampleID'].values,
        leaf_rotation=90,  # Rotate labels for better readability
        leaf_font_size=10  # Font size for labels
    )
    plt.title('Hierarchical Clustering Dendrogram')
    plt.xlabel('Sample ID')
    plt.ylabel('Euclidean Distance')
    plt.show()


# Example Usage
# Replace with paths to your count matrix and metadata files
count_matrix_file = '5_X_Normalized_Data_final_GSE233233_QZ_006.csv'
metadata_file = 'Meta_Data_final_GSE233233_QZ_006.csv'

# Load and visualize data
df = load_data(count_matrix_file, metadata_file)
plot_hierarchical_tree(df)
